//   Copyright 2013-2014 Fran√ßois de Campredon
//
//   Licensed under the Apache License, Version 2.0 (the "License");
//   you may not use this file except in compliance with the License.
//   You may obtain a copy of the License at
//
//       http://www.apache.org/licenses/LICENSE-2.0
//
//   Unless required by applicable law or agreed to in writing, software
//   distributed under the License is distributed on an "AS IS" BASIS,
//   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
//   See the License for the specific language governing permissions and
//   limitations under the License.
'use strict';
var path = require('path');
function mapValues(map) {
    return Object.keys(map).reduce(function (result, key) {
        result.push(map[key]);
        return result;
    }, []);
}
exports.mapValues = mapValues;
/**
 * assign all properties of a list of object to an object
 * @param target the object that will receive properties
 * @param items items which properties will be assigned to a target
 */
function assign(target) {
    var items = [];
    for (var _i = 1; _i < arguments.length; _i++) {
        items[_i - 1] = arguments[_i];
    }
    return items.reduce(function (target, source) {
        return Object.keys(source).reduce(function (target, key) {
            target[key] = source[key];
            return target;
        }, target);
    }, target);
}
exports.assign = assign;
/**
 * clone an object (shallow)
 * @param target the object to clone
 */
function clone(target) {
    return assign(Array.isArray(target) ? [] : {}, target);
}
exports.clone = clone;
/**
 * Create a quick lookup map from list
 */
function createMap(arr) {
    return arr.reduce(function (result, key) {
        result[key] = true;
        return result;
    }, {});
}
exports.createMap = createMap;
/**
 * browserify path.resolve is buggy on windows
 */
function pathResolve(from, to) {
    var result = path.resolve(from, to);
    var index = result.indexOf(from[0]);
    return result.slice(index);
}
exports.pathResolve = pathResolve;
var Signal = (function () {
    function Signal() {
        /**
         * list of listeners that have been suscribed to this signal
         */
        this.listeners = [];
        /**
         * Priorities corresponding to the listeners
         */
        this.priorities = [];
    }
    /**
     * Subscribes a listener for the signal.
     *
     * @params listener the callback to call when events are dispatched
     * @params priority an optional priority for this signal
     */
    Signal.prototype.add = function (listener, priority) {
        if (priority === void 0) { priority = 0; }
        var index = this.listeners.indexOf(listener);
        if (index !== -1) {
            this.priorities[index] = priority;
            return;
        }
        for (var i = 0, l = this.priorities.length; i < l; i++) {
            if (this.priorities[i] < priority) {
                this.priorities.splice(i, 0, priority);
                this.listeners.splice(i, 0, listener);
                return;
            }
        }
        this.priorities.push(priority);
        this.listeners.push(listener);
    };
    /**
     * unsubscribe a listener for the signal
     *
     * @params listener the previously subscribed listener
     */
    Signal.prototype.remove = function (listener) {
        var index = this.listeners.indexOf(listener);
        if (index >= 0) {
            this.priorities.splice(index, 1);
            this.listeners.splice(index, 1);
        }
    };
    /**
     * dispatch an event
     *
     * @params parameter the parameter attached to the event dispatching
     */
    Signal.prototype.dispatch = function (parameter) {
        var hasBeenCanceled = this.listeners.every(function (listener) {
            var result = listener(parameter);
            return result !== false;
        });
        return hasBeenCanceled;
    };
    /**
     * Remove all listener from the signal
     */
    Signal.prototype.clear = function () {
        this.listeners = [];
        this.priorities = [];
    };
    /**
     * @return true if the listener has been subsribed to this signal
     */
    Signal.prototype.hasListeners = function () {
        return this.listeners.length > 0;
    };
    return Signal;
})();
exports.Signal = Signal;
function binarySearch(array, value) {
    var low = 0;
    var high = array.length - 1;
    while (low <= high) {
        var middle = low + ((high - low) >> 1);
        var midValue = array[middle];
        if (midValue === value) {
            return middle;
        }
        else if (midValue > value) {
            high = middle - 1;
        }
        else {
            low = middle + 1;
        }
    }
    return ~low;
}
exports.binarySearch = binarySearch;
// Not optimized
function selectMany(arr) {
    var result = [];
    for (var i = 0; i < arr.length; i++) {
        for (var j = 0; j < arr[i].length; j++) {
            result.push(arr[i][j]);
        }
    }
    return result;
}
exports.selectMany = selectMany;
// Not particularly awesome e.g. '/..foo' will pass
function pathIsRelative(str) {
    if (!str.length)
        return false;
    return str[0] == '.' || str.substring(0, 2) == "./" || str.substring(0, 3) == "../";
}
exports.pathIsRelative = pathIsRelative;
/** Key is string. Note: this data structure might have been a bad idea. Sorry. */
var Dict = (function () {
    function Dict() {
        this.table = Object.create(null);
    }
    Dict.prototype.setValue = function (key, item) {
        this.table[key] = item;
    };
    Dict.prototype.getValue = function (key) {
        return this.table[key];
    };
    Dict.prototype.clearValue = function (key) {
        delete this.table[key];
    };
    Dict.prototype.clearAll = function () {
        this.table = Object.create(null);
    };
    Dict.prototype.keys = function () {
        return Object.keys(this.table);
    };
    Dict.prototype.values = function () {
        var array = [];
        for (var key in this.table) {
            array.push(this.table[key]);
        }
        return array;
    };
    return Dict;
})();
exports.Dict = Dict;
/** for testing ui lags only */
function delay(seconds) {
    if (seconds === void 0) { seconds = 2; }
    delayMilliseconds(seconds * 1000);
}
exports.delay = delay;
;
function delayMilliseconds(milliseconds) {
    if (milliseconds === void 0) { milliseconds = 100; }
    // Delay the thread
    var d1 = new Date();
    var d2 = new Date();
    while (d2.valueOf() < d1.valueOf() + milliseconds) {
        d2 = new Date();
    }
}
exports.delayMilliseconds = delayMilliseconds;
;
var now = function () { return new Date().getTime(); };
function debounce(func, milliseconds, immediate) {
    if (immediate === void 0) { immediate = false; }
    var timeout, args, context, timestamp, result;
    var wait = milliseconds;
    var later = function () {
        var last = now() - timestamp;
        if (last < wait && last > 0) {
            timeout = setTimeout(later, wait - last);
        }
        else {
            timeout = null;
            if (!immediate) {
                result = func.apply(context, args);
                if (!timeout)
                    context = args = null;
            }
        }
    };
    return function () {
        context = this;
        args = arguments;
        timestamp = now();
        var callNow = immediate && !timeout;
        if (!timeout)
            timeout = setTimeout(later, wait);
        if (callNow) {
            result = func.apply(context, args);
            context = args = null;
        }
        return result;
    };
}
exports.debounce = debounce;
;
var punctuations = createMap([';', '{', '}', '(', ')', '.', ':', '<', '>', "'", '"']);
exports.prefixEndsInPunctuation = function (prefix) { return prefix.length && prefix.trim().length && punctuations[prefix.trim()[prefix.trim().length - 1]]; };
var nameExtractorRegex = /return (.*);/;
/** Get the name using a lambda so that you don't have magic strings */
function getName(nameLambda) {
    var m = nameExtractorRegex.exec(nameLambda + "");
    if (m == null)
        throw new Error("The function does not contain a statement matching 'return variableName;'");
    var access = m[1].split('.');
    return access[access.length - 1];
}
exports.getName = getName;
/** Sloppy but effective code to find distinct */
function distinct(arr) {
    var map = createMap(arr);
    return Object.keys(map);
}
exports.distinct = distinct;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL1VzZXJzL3NoYW5ub25iZXJ0dWNjaS8uZG90ZmlsZXMvYXRvbS5zeW1saW5rL3BhY2thZ2VzL2F0b20tdHlwZXNjcmlwdC9saWIvbWFpbi9sYW5nL3V0aWxzLnRzIiwic291cmNlcyI6WyIvVXNlcnMvc2hhbm5vbmJlcnR1Y2NpLy5kb3RmaWxlcy9hdG9tLnN5bWxpbmsvcGFja2FnZXMvYXRvbS10eXBlc2NyaXB0L2xpYi9tYWluL2xhbmcvdXRpbHMudHMiXSwibmFtZXMiOlsibWFwVmFsdWVzIiwiYXNzaWduIiwiY2xvbmUiLCJjcmVhdGVNYXAiLCJwYXRoUmVzb2x2ZSIsIlNpZ25hbCIsIlNpZ25hbC5jb25zdHJ1Y3RvciIsIlNpZ25hbC5hZGQiLCJTaWduYWwucmVtb3ZlIiwiU2lnbmFsLmRpc3BhdGNoIiwiU2lnbmFsLmNsZWFyIiwiU2lnbmFsLmhhc0xpc3RlbmVycyIsImJpbmFyeVNlYXJjaCIsInNlbGVjdE1hbnkiLCJwYXRoSXNSZWxhdGl2ZSIsIkRpY3QiLCJEaWN0LmNvbnN0cnVjdG9yIiwiRGljdC5zZXRWYWx1ZSIsIkRpY3QuZ2V0VmFsdWUiLCJEaWN0LmNsZWFyVmFsdWUiLCJEaWN0LmNsZWFyQWxsIiwiRGljdC5rZXlzIiwiRGljdC52YWx1ZXMiLCJkZWxheSIsImRlbGF5TWlsbGlzZWNvbmRzIiwiZGVib3VuY2UiLCJnZXROYW1lIiwiZGlzdGluY3QiXSwibWFwcGluZ3MiOiJBQUFBLDhDQUE4QztBQUM5QyxFQUFFO0FBQ0Ysb0VBQW9FO0FBQ3BFLHFFQUFxRTtBQUNyRSw0Q0FBNEM7QUFDNUMsRUFBRTtBQUNGLG1EQUFtRDtBQUNuRCxFQUFFO0FBQ0Ysd0VBQXdFO0FBQ3hFLHNFQUFzRTtBQUN0RSw2RUFBNkU7QUFDN0Usd0VBQXdFO0FBQ3hFLG1DQUFtQztBQUVuQyxZQUFZLENBQUM7QUFFYixJQUFPLElBQUksV0FBVyxNQUFNLENBQUMsQ0FBQztBQUU5QixTQUFnQixTQUFTLENBQUksR0FBMkI7SUFDcERBLE1BQU1BLENBQUNBLE1BQU1B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QUNBLENBQUNBO1lBQ2ZBLElBQUlBLENBQUNBLFVBQVVBLENBQUNBLEtBQUtBLENBQUNBLEdBQUdBLFFBQVFBLENBQUNBO1lBQ2xDQSxNQUFNQSxDQUFDQTtRQUNYQSxDQUFDQTtRQUNEQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQSxHQUFHQSxJQUFJQSxDQUFDQSxVQUFVQSxDQUFDQSxNQUFNQSxFQUFFQSxDQUFDQSxHQUFHQSxDQUFDQSxFQUFFQSxDQUFDQSxFQUFFQSxFQUFFQSxDQUFDQTtZQUNyREEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsUUFBUUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7Z0JBQ2hDQSxJQUFJQSxDQUFDQSxVQUFVQSxDQUFDQSxNQUFNQSxDQUFDQSxDQUFDQSxFQUFFQSxDQUFDQSxFQUFFQSxRQUFRQSxDQUFDQSxDQUFDQTtnQkFDdkNBLElBQUlBLENBQUNBLFNBQVNBLENBQUNBLE1BQU1BLENBQUNBLENBQUNBLEVBQUVBLENBQUNBLEVBQUVBLFFBQVFBLENBQUNBLENBQUNBO2dCQUN0Q0EsTUFBTUEsQ0FBQ0E7WUFDWEEsQ0FBQ0E7UUFDTEEsQ0FBQ0E7UUFDREEsSUFBSUEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsQ0FBQ0E7UUFDL0JBLElBQUlBLENBQUNBLFNBQVNBLENBQUNBLElBQUlBLENBQUNBLFFBQVFBLENBQUNBLENBQUNBO0lBQ2xDQSxDQUFDQTtJQUVERjs7OztPQUlHQTtJQUNIQSx1QkFBTUEsR0FBTkEsVUFBT0EsUUFBK0JBO1FBQ2xDRyxJQUFJQSxLQUFLQSxHQUFHQSxJQUFJQSxDQUFDQSxTQUFTQSxDQUFDQSxPQUFPQSxDQUFDQSxRQUFRQSxDQUFDQSxDQUFDQTtRQUM3Q0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsS0FBS0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDYkEsSUFBSUEsQ0FB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QyxDQUFDLEVBQTlGLENBQThGLENBQUM7QUFFaEosSUFBSSxrQkFBa0IsR0FBRyxjQUFjLENBQUM7QUFFeEMsQUFEQSx1RUFBdUU7U0FDdkQsT0FBTyxDQUFDLFVBQXFCO0lBQ3pDQyxJQUFJQSxDQUFDQSxHQUFHQSxrQkFBa0JBLENBQUNBLElBQUlBLENBQUNBLFVBQVVBLEdBQUdBLEVBQUVBLENBQUNBLENBQUNBO0lBQ2pEQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQSxJQUFJQSxJQUFJQSxDQUFDQTtRQUNWQSxNQUFNQSxJQUFJQSxLQUFLQSxDQUFDQSwyRUFBMkVBLENBQUNBLENBQUNBO0lBQ2pHQSxJQUFJQSxNQUFNQSxHQUFHQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxLQUFLQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQTtJQUM3QkEsTUFBTUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsTUFBTUEsR0FBR0EsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7QUFDckNBLENBQUNBO0FBTmUsZUFBTyxHQUFQLE9BTWYsQ0FBQTtBQUdELEFBREEsaURBQWlEO1NBQ2pDLFFBQVEsQ0FBQyxHQUFhO0lBQ2xDQyxJQUFJQSxHQUFHQSxHQUFHQSxTQUFTQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQTtJQUN6QkEsTUFBTUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7QUFDNUJBLENBQUNBO0FBSGUsZ0JBQVEsR0FBUixRQUdmLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyIvLyAgIENvcHlyaWdodCAyMDEzLTIwMTQgRnJhbsOnb2lzIGRlIENhbXByZWRvblxuLy9cbi8vICAgTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbi8vICAgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuLy8gICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbi8vXG4vLyAgICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbi8vXG4vLyAgIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbi8vICAgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuLy8gICBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbi8vICAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuLy8gICBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cblxuJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcblxuZXhwb3J0IGZ1bmN0aW9uIG1hcFZhbHVlczxUPihtYXA6IHsgW2luZGV4OiBzdHJpbmddOiBUIH0pOiBUW10ge1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhtYXApLnJlZHVjZSgocmVzdWx0OiBUW10sIGtleTogc3RyaW5nKSA9PiB7XG4gICAgICAgIHJlc3VsdC5wdXNoKG1hcFtrZXldKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9LCBbXSk7XG59XG5cbi8qKlxuICogYXNzaWduIGFsbCBwcm9wZXJ0aWVzIG9mIGEgbGlzdCBvZiBvYmplY3QgdG8gYW4gb2JqZWN0XG4gKiBAcGFyYW0gdGFyZ2V0IHRoZSBvYmplY3QgdGhhdCB3aWxsIHJlY2VpdmUgcHJvcGVydGllc1xuICogQHBhcmFtIGl0ZW1zIGl0ZW1zIHdoaWNoIHByb3BlcnRpZXMgd2lsbCBiZSBhc3NpZ25lZCB0byBhIHRhcmdldFxuICovXG5leHBvcnQgZnVuY3Rpb24gYXNzaWduKHRhcmdldDogYW55LCAuLi5pdGVtczogYW55W10pOiBhbnkge1xuICAgIHJldHVybiBpdGVtcy5yZWR1Y2UoZnVuY3Rpb24odGFyZ2V0OiBhbnksIHNvdXJjZTogYW55KSB7XG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhzb3VyY2UpLnJlZHVjZSgodGFyZ2V0OiBhbnksIGtleTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICAgICAgfSwgdGFyZ2V0KTtcbiAgICB9LCB0YXJnZXQpO1xufVxuXG4vKipcbiAqIGNsb25lIGFuIG9iamVjdCAoc2hhbGxvdylcbiAqIEBwYXJhbSB0YXJnZXQgdGhlIG9iamVjdCB0byBjbG9uZVxuICovXG5leHBvcnQgZnVuY3Rpb24gY2xvbmU8VD4odGFyZ2V0OiBUKTogVCB7XG4gICAgcmV0dXJuIGFzc2lnbihBcnJheS5pc0FycmF5KHRhcmdldCkgPyBbXSA6IHt9LCB0YXJnZXQpO1xufVxuXG4vKipcbiAqIENyZWF0ZSBhIHF1aWNrIGxvb2t1cCBtYXAgZnJvbSBsaXN0XG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVNYXAoYXJyOiAoc3RyaW5nfG51bWJlcilbXSk6IHsgW3N0cmluZzogc3RyaW5nXTogYm9vbGVhbjtbbnVtYmVyOiBudW1iZXJdOiBib29sZWFuIH0ge1xuICAgIHJldHVybiBhcnIucmVkdWNlKChyZXN1bHQ6IHsgW3N0cmluZzogc3RyaW5nXTogYm9vbGVhbiB9LCBrZXk6IHN0cmluZykgPT4ge1xuICAgICAgICByZXN1bHRba2V5XSA9IHRydWU7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSwgPHsgW3N0cmluZzogc3RyaW5nXTogYm9vbGVhbiB9Pnt9KTtcbn1cblxuXG4vKipcbiAqIGJyb3dzZXJpZnkgcGF0aC5yZXNvbHZlIGlzIGJ1Z2d5IG9uIHdpbmRvd3NcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHBhdGhSZXNvbHZlKGZyb206IHN0cmluZywgdG86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgdmFyIHJlc3VsdCA9IHBhdGgucmVzb2x2ZShmcm9tLCB0byk7XG4gICAgdmFyIGluZGV4ID0gcmVzdWx0LmluZGV4T2YoZnJvbVswXSk7XG4gICAgcmV0dXJuIHJlc3VsdC5zbGljZShpbmRleCk7XG59XG5cblxuLyoqXG4gKiBDIyBsaWtlIGV2ZW50cyBhbmQgZGVsZWdhdGVzIGZvciB0eXBlZCBldmVudHNcbiAqIGRpc3BhdGNoaW5nXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgSVNpZ25hbDxUPiB7XG4gICAgLyoqXG4gICAgICogU3Vic2NyaWJlcyBhIGxpc3RlbmVyIGZvciB0aGUgc2lnbmFsLlxuICAgICAqXG4gICAgICogQHBhcmFtcyBsaXN0ZW5lciB0aGUgY2FsbGJhY2sgdG8gY2FsbCB3aGVuIGV2ZW50cyBhcmUgZGlzcGF0Y2hlZFxuICAgICAqIEBwYXJhbXMgcHJpb3JpdHkgYW4gb3B0aW9uYWwgcHJpb3JpdHkgZm9yIHRoaXMgc2lnbmFsXG4gICAgICovXG4gICAgYWRkKGxpc3RlbmVyOiAocGFyYW1ldGVyOiBUKSA9PiBhbnksIHByaW9yaXR5PzogbnVtYmVyKTogdm9pZDtcblxuICAgIC8qKlxuICAgICAqIHVuc3Vic2NyaWJlIGEgbGlzdGVuZXIgZm9yIHRoZSBzaWduYWxcbiAgICAgKlxuICAgICAqIEBwYXJhbXMgbGlzdGVuZXIgdGhlIHByZXZpb3VzbHkgc3Vic2NyaWJlZCBsaXN0ZW5lclxuICAgICAqL1xuICAgIHJlbW92ZShsaXN0ZW5lcjogKHBhcmFtZXRlcjogVCkgPT4gYW55KTogdm9pZDtcblxuICAgIC8qKlxuICAgICAqIGRpc3BhdGNoIGFuIGV2ZW50XG4gICAgICpcbiAgICAgKiBAcGFyYW1zIHBhcmFtZXRlciB0aGUgcGFyYW1ldGVyIGF0dGFjaGVkIHRvIHRoZSBldmVudCBkaXNwYXRjaGluZ1xuICAgICAqL1xuICAgIGRpc3BhdGNoKHBhcmFtZXRlcj86IFQpOiBib29sZWFuO1xuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGFsbCBsaXN0ZW5lciBmcm9tIHRoZSBzaWduYWxcbiAgICAgKi9cbiAgICBjbGVhcigpOiB2b2lkO1xuXG4gICAgLyoqXG4gICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBsaXN0ZW5lciBoYXMgYmVlbiBzdWJzcmliZWQgdG8gdGhpcyBzaWduYWxcbiAgICAgKi9cbiAgICBoYXNMaXN0ZW5lcnMoKTogYm9vbGVhbjtcbn1cblxuXG5leHBvcnQgY2xhc3MgU2lnbmFsPFQ+IGltcGxlbWVudHMgSVNpZ25hbDxUPiB7XG5cbiAgICAvKipcbiAgICAgKiBsaXN0IG9mIGxpc3RlbmVycyB0aGF0IGhhdmUgYmVlbiBzdXNjcmliZWQgdG8gdGhpcyBzaWduYWxcbiAgICAgKi9cbiAgICBwcml2YXRlIGxpc3RlbmVyczogeyAocGFyYW1ldGVyOiBUKTogYW55IH1bXSA9IFtdO1xuXG4gICAgLyoqXG4gICAgICogUHJpb3JpdGllcyBjb3JyZXNwb25kaW5nIHRvIHRoZSBsaXN0ZW5lcnNcbiAgICAgKi9cbiAgICBwcml2YXRlIHByaW9yaXRpZXM6IG51bWJlcltdID0gW107XG5cbiAgICAvKipcbiAgICAgKiBTdWJzY3JpYmVzIGEgbGlzdGVuZXIgZm9yIHRoZSBzaWduYWwuXG4gICAgICpcbiAgICAgKiBAcGFyYW1zIGxpc3RlbmVyIHRoZSBjYWxsYmFjayB0byBjYWxsIHdoZW4gZXZlbnRzIGFyZSBkaXNwYXRjaGVkXG4gICAgICogQHBhcmFtcyBwcmlvcml0eSBhbiBvcHRpb25hbCBwcmlvcml0eSBmb3IgdGhpcyBzaWduYWxcbiAgICAgKi9cbiAgICBhZGQobGlzdGVuZXI6IChwYXJhbWV0ZXI6IFQpID0+IGFueSwgcHJpb3JpdHkgPSAwKTogdm9pZCB7XG4gICAgICAgIHZhciBpbmRleCA9IHRoaXMubGlzdGVuZXJzLmluZGV4T2YobGlzdGVuZXIpO1xuICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICB0aGlzLnByaW9yaXRpZXNbaW5kZXhdID0gcHJpb3JpdHk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSB0aGlzLnByaW9yaXRpZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wcmlvcml0aWVzW2ldIDwgcHJpb3JpdHkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByaW9yaXRpZXMuc3BsaWNlKGksIDAsIHByaW9yaXR5KTtcbiAgICAgICAgICAgICAgICB0aGlzLmxpc3RlbmVycy5zcGxpY2UoaSwgMCwgbGlzdGVuZXIpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnByaW9yaXRpZXMucHVzaChwcmlvcml0eSk7XG4gICAgICAgIHRoaXMubGlzdGVuZXJzLnB1c2gobGlzdGVuZXIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHVuc3Vic2NyaWJlIGEgbGlzdGVuZXIgZm9yIHRoZSBzaWduYWxcbiAgICAgKlxuICAgICAqIEBwYXJhbXMgbGlzdGVuZXIgdGhlIHByZXZpb3VzbHkgc3Vic2NyaWJlZCBsaXN0ZW5lclxuICAgICAqL1xuICAgIHJlbW92ZShsaXN0ZW5lcjogKHBhcmFtZXRlcjogVCkgPT4gYW55KTogdm9pZCB7XG4gICAgICAgIHZhciBpbmRleCA9IHRoaXMubGlzdGVuZXJzLmluZGV4T2YobGlzdGVuZXIpO1xuICAgICAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgICAgICAgdGhpcy5wcmlvcml0aWVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB0aGlzLmxpc3RlbmVycy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogZGlzcGF0Y2ggYW4gZXZlbnRcbiAgICAgKlxuICAgICAqIEBwYXJhbXMgcGFyYW1ldGVyIHRoZSBwYXJhbWV0ZXIgYXR0YWNoZWQgdG8gdGhlIGV2ZW50IGRpc3BhdGNoaW5nXG4gICAgICovXG4gICAgZGlzcGF0Y2gocGFyYW1ldGVyPzogVCk6IGJvb2xlYW4ge1xuICAgICAgICB2YXIgaGFzQmVlbkNhbmNlbGVkID0gdGhpcy5saXN0ZW5lcnMuZXZlcnkoKGxpc3RlbmVyOiAocGFyYW1ldGVyOiBUKSA9PiBhbnkpID0+IHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBsaXN0ZW5lcihwYXJhbWV0ZXIpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdCAhPT0gZmFsc2U7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBoYXNCZWVuQ2FuY2VsZWQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVtb3ZlIGFsbCBsaXN0ZW5lciBmcm9tIHRoZSBzaWduYWxcbiAgICAgKi9cbiAgICBjbGVhcigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMgPSBbXTtcbiAgICAgICAgdGhpcy5wcmlvcml0aWVzID0gW107XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBsaXN0ZW5lciBoYXMgYmVlbiBzdWJzcmliZWQgdG8gdGhpcyBzaWduYWxcbiAgICAgKi9cbiAgICBoYXNMaXN0ZW5lcnMoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmxpc3RlbmVycy5sZW5ndGggPiAwO1xuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGJpbmFyeVNlYXJjaChhcnJheTogbnVtYmVyW10sIHZhbHVlOiBudW1iZXIpOiBudW1iZXIge1xuICAgIHZhciBsb3cgPSAwO1xuICAgIHZhciBoaWdoID0gYXJyYXkubGVuZ3RoIC0gMTtcblxuICAgIHdoaWxlIChsb3cgPD0gaGlnaCkge1xuICAgICAgICB2YXIgbWlkZGxlID0gbG93ICsgKChoaWdoIC0gbG93KSA+PiAxKTtcbiAgICAgICAgdmFyIG1pZFZhbHVlID0gYXJyYXlbbWlkZGxlXTtcblxuICAgICAgICBpZiAobWlkVmFsdWUgPT09IHZhbHVlKSB7XG4gICAgICAgICAgICByZXR1cm4gbWlkZGxlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKG1pZFZhbHVlID4gdmFsdWUpIHtcbiAgICAgICAgICAgIGhpZ2ggPSBtaWRkbGUgLSAxO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbG93ID0gbWlkZGxlICsgMTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB+bG93O1xufVxuXG4vLyBOb3Qgb3B0aW1pemVkXG5leHBvcnQgZnVuY3Rpb24gc2VsZWN0TWFueTxUPihhcnI6IFRbXVtdKTogVFtdIHtcbiAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBhcnJbaV0ubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKGFycltpXVtqXSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLy8gTm90IHBhcnRpY3VsYXJseSBhd2Vzb21lIGUuZy4gJy8uLmZvbycgd2lsbCBwYXNzXG5leHBvcnQgZnVuY3Rpb24gcGF0aElzUmVsYXRpdmUoc3RyOiBzdHJpbmcpIHtcbiAgICBpZiAoIXN0ci5sZW5ndGgpIHJldHVybiBmYWxzZTtcbiAgICByZXR1cm4gc3RyWzBdID09ICcuJyB8fCBzdHIuc3Vic3RyaW5nKDAsIDIpID09IFwiLi9cIiB8fCBzdHIuc3Vic3RyaW5nKDAsIDMpID09IFwiLi4vXCI7XG59XG5cbi8qKiBLZXkgaXMgc3RyaW5nLiBOb3RlOiB0aGlzIGRhdGEgc3RydWN0dXJlIG1pZ2h0IGhhdmUgYmVlbiBhIGJhZCBpZGVhLiBTb3JyeS4gKi9cbmV4cG9ydCBjbGFzcyBEaWN0PFQ+e1xuICAgIHB1YmxpYyB0YWJsZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gICAgY29uc3RydWN0b3IoKSB7IH1cbiAgICBzZXRWYWx1ZShrZXk6IHN0cmluZywgaXRlbTogVCkge1xuICAgICAgICB0aGlzLnRhYmxlW2tleV0gPSBpdGVtO1xuICAgIH1cbiAgICBnZXRWYWx1ZShrZXk6IHN0cmluZykgeyByZXR1cm4gdGhpcy50YWJsZVtrZXldOyB9XG4gICAgY2xlYXJWYWx1ZShrZXk6IHN0cmluZykge1xuICAgICAgICBkZWxldGUgdGhpcy50YWJsZVtrZXldO1xuICAgIH1cbiAgICBjbGVhckFsbCgpIHsgdGhpcy50YWJsZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7IH1cbiAgICBrZXlzKCkgeyByZXR1cm4gT2JqZWN0LmtleXModGhpcy50YWJsZSk7IH1cbiAgICB2YWx1ZXMoKTogVFtdIHtcbiAgICAgICAgdmFyIGFycmF5ID0gW107XG4gICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLnRhYmxlKSB7XG4gICAgICAgICAgICBhcnJheS5wdXNoKHRoaXMudGFibGVba2V5XSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGFycmF5O1xuICAgIH1cbn1cblxuLyoqIGZvciB0ZXN0aW5nIHVpIGxhZ3Mgb25seSAqL1xuZXhwb3J0IGZ1bmN0aW9uIGRlbGF5KHNlY29uZHM6IG51bWJlciA9IDIpIHtcbiAgICBkZWxheU1pbGxpc2Vjb25kcyhzZWNvbmRzICogMTAwMCk7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZGVsYXlNaWxsaXNlY29uZHMobWlsbGlzZWNvbmRzOiBudW1iZXIgPSAxMDApIHtcbiAgICAvLyBEZWxheSB0aGUgdGhyZWFkXG4gICAgdmFyIGQxID0gbmV3IERhdGUoKTtcbiAgICB2YXIgZDIgPSBuZXcgRGF0ZSgpO1xuICAgIHdoaWxlIChkMi52YWx1ZU9mKCkgPCBkMS52YWx1ZU9mKCkgKyBtaWxsaXNlY29uZHMpIHtcbiAgICAgICAgZDIgPSBuZXcgRGF0ZSgpO1xuICAgIH1cbn07XG5cbnZhciBub3cgPSAoKSA9PiBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcblxuZXhwb3J0IGZ1bmN0aW9uIGRlYm91bmNlPFQgZXh0ZW5kcyBGdW5jdGlvbj4oZnVuYzogVCwgbWlsbGlzZWNvbmRzOiBudW1iZXIsIGltbWVkaWF0ZSA9IGZhbHNlKTogVCB7XG4gICAgdmFyIHRpbWVvdXQsIGFyZ3MsIGNvbnRleHQsIHRpbWVzdGFtcCwgcmVzdWx0O1xuXG4gICAgdmFyIHdhaXQgPSBtaWxsaXNlY29uZHM7XG5cbiAgICB2YXIgbGF0ZXIgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGxhc3QgPSBub3coKSAtIHRpbWVzdGFtcDtcblxuICAgICAgICBpZiAobGFzdCA8IHdhaXQgJiYgbGFzdCA+IDApIHtcbiAgICAgICAgICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0IC0gbGFzdCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aW1lb3V0ID0gbnVsbDtcbiAgICAgICAgICAgIGlmICghaW1tZWRpYXRlKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgICAgICAgICBpZiAoIXRpbWVvdXQpIGNvbnRleHQgPSBhcmdzID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4gPGFueT5mdW5jdGlvbigpIHtcbiAgICAgICAgY29udGV4dCA9IHRoaXM7XG4gICAgICAgIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICAgIHRpbWVzdGFtcCA9IG5vdygpO1xuICAgICAgICB2YXIgY2FsbE5vdyA9IGltbWVkaWF0ZSAmJiAhdGltZW91dDtcbiAgICAgICAgaWYgKCF0aW1lb3V0KSB0aW1lb3V0ID0gc2V0VGltZW91dChsYXRlciwgd2FpdCk7XG4gICAgICAgIGlmIChjYWxsTm93KSB7XG4gICAgICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgICAgICAgY29udGV4dCA9IGFyZ3MgPSBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xufTtcblxudmFyIHB1bmN0dWF0aW9ucyA9IGNyZWF0ZU1hcChbJzsnLCAneycsICd9JywgJygnLCAnKScsICcuJywgJzonLCAnPCcsICc+JywgXCInXCIsICdcIiddKTtcbmV4cG9ydCB2YXIgcHJlZml4RW5kc0luUHVuY3R1YXRpb24gPSAocHJlZml4KSA9PiBwcmVmaXgubGVuZ3RoICYmIHByZWZpeC50cmltKCkubGVuZ3RoICYmIHB1bmN0dWF0aW9uc1twcmVmaXgudHJpbSgpW3ByZWZpeC50cmltKCkubGVuZ3RoIC0gMV1dO1xuXG52YXIgbmFtZUV4dHJhY3RvclJlZ2V4ID0gL3JldHVybiAoLiopOy87XG4vKiogR2V0IHRoZSBuYW1lIHVzaW5nIGEgbGFtYmRhIHNvIHRoYXQgeW91IGRvbid0IGhhdmUgbWFnaWMgc3RyaW5ncyAqL1xuZXhwb3J0IGZ1bmN0aW9uIGdldE5hbWUobmFtZUxhbWJkYTogKCkgPT4gYW55KSB7XG4gICAgdmFyIG0gPSBuYW1lRXh0cmFjdG9yUmVnZXguZXhlYyhuYW1lTGFtYmRhICsgXCJcIik7XG4gICAgaWYgKG0gPT0gbnVsbClcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIGZ1bmN0aW9uIGRvZXMgbm90IGNvbnRhaW4gYSBzdGF0ZW1lbnQgbWF0Y2hpbmcgJ3JldHVybiB2YXJpYWJsZU5hbWU7J1wiKTtcbiAgICB2YXIgYWNjZXNzID0gbVsxXS5zcGxpdCgnLicpO1xuICAgIHJldHVybiBhY2Nlc3NbYWNjZXNzLmxlbmd0aCAtIDFdO1xufVxuXG4vKiogU2xvcHB5IGJ1dCBlZmZlY3RpdmUgY29kZSB0byBmaW5kIGRpc3RpbmN0ICovXG5leHBvcnQgZnVuY3Rpb24gZGlzdGluY3QoYXJyOiBzdHJpbmdbXSk6IHN0cmluZ1tdIHtcbiAgICB2YXIgbWFwID0gY3JlYXRlTWFwKGFycik7XG4gICAgcmV0dXJuIE9iamVjdC5rZXlzKG1hcCk7XG59Il19
//# sourceURL=/Users/shannonbertucci/.dotfiles/atom.symlink/packages/atom-typescript/lib/main/lang/utils.ts
